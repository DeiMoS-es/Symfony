<div class="row g-3">
  {% for movie in movies.items %}
    <div class="col-6 col-md-4 col-lg-3">
      <div class="card h-100 shadow-sm">
        {% if movie.posterPath %}
          <img src="https://media.themoviedb.org/t/p/w220_and_h330_face{{ movie.posterPath }}"
               class="card-img-top img-fluid"
               alt="{{ movie.title }}">
        {% else %}
          <img src="/images/placeholder.png"
               class="card-img-top img-fluid"
               alt="Sin imagen">
        {% endif %}
        
        <div class="card-body p-2 d-flex flex-column"> {# Cambiado para empujar el bot칩n abajo #}
          <h6 class="card-title text-truncate">{{ movie.title }}</h6>
          
          {% if movie.releaseDate %}
            <small class="text-muted mb-2 d-block">
              Estreno: {{ movie.releaseDate|date('d/m/Y') }}
            </small>
          {% endif %}

          {# --- BOT칍N DE RECOMENDAR --- #}
          {# Solo mostramos el bot칩n si la variable 'group' ha sido enviada desde el controlador #}
          {% if group is defined and group is not null %}
            <div class="mt-auto">
                <a href="{{ path('app_group_recommend_movie', { 'id': group.id, 'tmdbId': movie.tmdbId }) }}" 
                  class="btn btn-sm btn-primary w-100">
                  游꿟 Recomendar
                </a>
            </div>
          {% else %}
            <div class="mt-auto">
                <span class="badge bg-secondary w-100">Entra en un grupo para recomendar</span>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  {% endfor %}
</div>

<nav aria-label="Paginaci칩n cat치logo" class="mt-4">
  <ul class="pagination justify-content-center">
    {% if movies.page > 1 %}
      <li class="page-item">
        <a class="page-link" href="{{ path('user_dashboard', { page: movies.page - 1 }) }}">Anterior</a>
      </li>
    {% endif %}
    <li class="page-item disabled">
      <span class="page-link">P치gina {{ movies.page }} de {{ movies.total_pages }}</span>
    </li>
    {% if movies.page < movies.total_pages %}
      <li class="page-item">
        <a class="page-link" href="{{ path('user_dashboard', { page: movies.page + 1 }) }}">Siguiente</a>
      </li>
    {% endif %}
  </ul>
</nav>
